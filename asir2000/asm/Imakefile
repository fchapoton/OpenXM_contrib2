/* $OpenXM: OpenXM_contrib2/asir2000/asm/Imakefile,v 1.1.1.1 1999/12/03 07:39:06 noro Exp $ */
#include "../include/Risa.tmpl"

#if defined(AlphaArchitecture) || (defined(MipsArchitecture) && defined(SGIArchitecture)) || defined(PowerPCArchitecture)
mdepsrc = asmalpha.c
mdepobj = asmalpha.o
#endif

#ifdef LinuxArchitecture
#if !defined(AlphaArchitecture) && !defined(PowerPCArchitecture)
mdepsrc = asmi_l.s
mdepobj = asmi_l.o
#endif
#endif

#ifdef i386BsdArchitecture
#if defined(FreeBSDArchitecture) && OSMajorVersion >= 3
mdepsrc = asmi_l.s
mdepobj = asmi_l.o
#else
mdepsrc = asmi.s
mdepobj = asmi.o
#endif
#endif

#ifdef SunArchitecture
#if defined(i386Architecture)
mdepsrc = asmi_l.s
mdepobj = asmi_l.o
#else
mdepsrc = asm3.s
mdepobj = asm3.o
#endif
#endif

#ifdef SparcArchitecture
#if SystemV4
#if SUN4M
mdepsrc = sparc-2.s-cc asm5-2.s edr-2.s
mdepobj = sparc-2.o asm5-2.o edr-2.o
#else
mdepsrc = sparc-2.s-cc asm4-2.s edr-2.s
mdepobj = sparc-2.o asm4-2.o edr-2.o
#endif
#else
#if SUN4M
mdepsrc = sparc.c asm45.s edr.s
mdepobj = sparc.o asm45.o edr.o
#else
mdepsrc = sparc.c asm4.s edr.s
mdepobj = sparc.o asm4.o edr.o
#endif
#endif
#endif

#ifdef UltrixArchitecture
#ifdef VaxArchitecture
mdepsrc = asmv.s
mdepobj = asmv.o
#endif
#ifdef MipsArchitecture
mdepsrc = asmm.s
mdepobj = asmm.o
#endif
#endif

#ifdef HPArchitecture
/*
mdepsrc = asmh.s
mdepobj = asmh.o
*/
mdepsrc = asmalpha.c
mdepobj = asmalpha.o
#endif

#ifdef NeXTArchitecture
mdepsrc = asm3.s
mdepobj = asm3.o
#endif

#ifdef ApolloArchitecture
mdepsrc = asma.s
mdepobj = asma.o
#endif

#ifdef Mc88000Architecture
mdepsrc = asml.s
mdepobj = asml.o
#endif

#ifdef SonyArchitecture
#ifdef Mc68020Architecture
mdepsrc = asmn.s
mdepobj = asmn.o
#endif
#ifdef MipsArchitecture
mdepsrc = asmm.s
mdepobj = asmm.o
#endif
#endif

CSRC = ddM.c ddN.c
SRCS = $(CSRC) $(mdepsrc)

COBJ = ddM.o ddN.o
OBJS = $(COBJ) $(mdepobj)

NormalLibraryTarget(asm,$(OBJS))
DependTarget()

asmm.o asma.o:
	$(RM) $@
	$(AS) -o $@ $(INCLUDES) $*.s

asmh.o:
	$(RM) $@
	$(CC) -c -o $@ $(INCLUDES) $*.s

asm4.o asm4-2.o asm45.o asm45-2.o asm5.o asm5-2.o edr.o edr-2.o:
	$(RM) $@
	$(AS) -o $@ -P $(INCLUDES) $*.s

sparc.o: sparc.s-cc
	as -o sparc.o sparc.s-cc

sparc-2.o: sparc-2.s-cc
	as -o sparc-2.o sparc-2.s-cc
